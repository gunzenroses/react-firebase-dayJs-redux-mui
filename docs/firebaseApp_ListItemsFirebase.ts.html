<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: firebaseApp/ListItemsFirebase.ts</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: firebaseApp/ListItemsFirebase.ts</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
  updateDoc,
  doc,
  where,
  addDoc,
  getDocs,
  deleteDoc,
  collection,
  getFirestore,
  query,
} from 'firebase/firestore';

import { StatusEnum } from 'utils/constants';
import { ModeToType } from 'utils/constants';

import { fireApp } from './firebaseApp';

/**
 * Class representing Firestore instance.
 * You can manipulate data of Todo Items list:
 * - get list data;
 * - add new item;
 * - delete item;
 * - change item data;
 */
class ListItemsFirebase {
  private readonly db;

  constructor() {
    this.db = getFirestore(fireApp);
  }

  /**
   * Get data of Todo Items list (as list of documents in 'todoList' collection Firestore).
   * @param {ModeType} type - determine which type of items ('in progress' | 'missed' | 'completed') should be rendered.
   * @returns {ListItem[]}.
   */
  async getListItem(type: ModeType) {
    const mode: string = ModeToType[type];
    const todoListRef = collection(this.db, 'todoList');
    const todoModListRef = query(todoListRef, where('status', '==', mode));

    const listSnapshot =
      mode === StatusEnum.all
        ? await getDocs(todoListRef)
        : await getDocs(todoModListRef);

    if (!listSnapshot.empty) {
      const list: ListItem[] = [];
      listSnapshot.forEach((doc) => {
        list.push({
          id: doc.id,
          data: doc.data() as ItemData,
        });
      });
      return list;
    }
    return [] as ListItem[];
  }

  /**
   * Update Todo Item's data (can be done partially) at Firestore collection.
   * @param {ListItemPartial} value - includes 'id' of Todo Item and 'data' that should be changed.
   * @returns {ListItemPartial}.
   */
  async updateListItem(value: ListItemPartial) {
    const { id, data } = value;
    const todoItemRef = doc(this.db, 'todoList', id);
    try {
      await updateDoc(todoItemRef, data);
      return value;
    } catch (error) {
      throw new Error("Can't update data");
    }
  }

  /**
   * Add new Todo Item and create its unique ID in Firestore collection.
   * @param {ItemData} data - new Todo Item information.
   * @returns {ListItem} - returns Todo Item 'ID' and 'data'.
   */
  async addListItem(data: ItemData) {
    const todoListRef = collection(this.db, 'todoList');
    try {
      const newItem = await addDoc(todoListRef, data);
      return {
        id: newItem.id,
        data: data,
      };
    } catch (error) {
      throw new Error("Can't add new item");
    }
  }

  /**
   * Delete Todo Item by it's unique ID from Firestore collection.
   * @param {string} id - containing ID which helps to find a document that has to be removed.
   * @returns {string}.
   */
  async deleteItem(id: string) {
    const todoListRef = collection(this.db, 'todoList');
    try {
      await deleteDoc(doc(todoListRef, id));
      return id;
    } catch (error) {
      throw new Error("Can't delete item");
    }
  }
}

export { ListItemsFirebase };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ButtonCheck.html">ButtonCheck</a></li><li><a href="FileHandler.html">FileHandler</a></li><li><a href="ItemCreator.html">ItemCreator</a></li><li><a href="ListItemsFirebase.html">ListItemsFirebase</a></li><li><a href="ModeList.html">ModeList</a></li><li><a href="MyButton.html">MyButton</a></li><li><a href="MyDatePicker.html">MyDatePicker</a></li><li><a href="MyIcon.html">MyIcon</a></li><li><a href="NavBar.html">NavBar</a></li><li><a href="StorageFirebase.html">StorageFirebase</a></li><li><a href="TodoItem.html">TodoItem</a></li><li><a href="TodoItemText.html">TodoItemText</a></li><li><a href="TodoList.html">TodoList</a></li></ul><h3>Global</h3><ul><li><a href="global.html#checkTimestampInPast">checkTimestampInPast</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Thu Dec 01 2022 01:58:02 GMT+0800 (Иркутск, стандартное время)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
